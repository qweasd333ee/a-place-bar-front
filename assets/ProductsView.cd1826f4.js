import{a0 as Q,aJ as c,ar as m,o as f,C as h,D as r,E as C,a as o,F as s,Q as u,az as p,c as v,aA as k,aB as U}from"./index.b944b107.js";import{Q as q,a as B}from"./QToolbar.ba41d720.js";import{Q as D,a as g}from"./QForm.2c1e5fd4.js";import{Q as S,a as T,b as F}from"./QToggle.35e8f0a1.js";import{Q as A}from"./QCardSection.bc494366.js";import{Q as $}from"./QCardActions.81c97904.js";import{Q as y}from"./QCard.ec34390a.js";import{Q as z}from"./QDialog.7ab3464b.js";import{Q as E}from"./QImg.d1d7164d.js";import{Q as I}from"./QMarkupTable.ed038416.js";import{Q as N}from"./QPage.ec7781b0.js";import"./use-dark.7ef67035.js";import"./uid.42677368.js";import"./focus-manager.d6507951.js";import"./QItemLabel.bd95feb5.js";import"./QMenu.75d945fd.js";import"./selection.8abc9abe.js";import"./use-prevent-scroll.38f096d9.js";import"./focusout.59e4dce0.js";import"./use-tick.c6c04792.js";import"./use-timeout.b540562e.js";import"./rtl.b51694b1.js";import"./format.865294d5.js";const P={id:"section01"},J={class:"container"},L={class:"row"},M=o("div",{class:"col-12 text-center text-white text-h3 text"},"\u9910\u9EDE\u7BA1\u7406",-1),j={class:"col-12 text-right"},G={class:"text-center"},H={class:"col-12"},K=o("thead",{class:"text-center"},[o("tr",null,[o("th",null,"\u7167\u7247"),o("th",null,"\u540D\u7A31"),o("th",null,"\u50F9\u683C"),o("th",null,"\u5206\u985E"),o("th",null,"\u4E0A\u67B6"),o("th",null,"\u7DE8\u8F2F")])],-1),O={class:"text-center"},ve={__name:"ProductsView",setup(R){const b=["shot","\u8336\u9152","\u7279\u8ABF","\u5976\u9152","\u5564\u9152","\u7121\u9152\u7CBE","\u62FC\u76E4","\u55AE\u9EDE"],d={required(a){return!!a||"\u6B04\u4F4D\u5FC5\u586B"},price(a){return a>=0||"\u50F9\u683C\u932F\u8AA4"}},i=Q([]),e=Q({_id:"",name:"",price:0,description:"",image:void 0,sell:!1,category:"",valid:!1,dialog:!1,idx:-1}),V=a=>{a===-1?(e._id="",e.name="",e.price=0,e.description="",e.image=void 0,e.sell=!1,e.category="",e.valid=!1,e.idx=-1):(e._id=i[a]._id,e.name=i[a].name,e.price=i[a].price,e.description=i[a].description,e.image=void 0,e.sell=i[a].sell,e.category=i[a].category,e.valid=!1,e.idx=a),e.dialog=!0},w=async()=>{var t,n;const a=new FormData;a.append("name",e.name),a.append("price",e.price),a.append("description",e.description),a.append("image",e.image),a.append("sell",e.sell),a.append("category",e.category);try{if(e._id.length===0){const{data:l}=await c.post("/products",a);i.push(l.result),m.fire({icon:"success",title:"\u6210\u529F",text:"\u65B0\u589E\u6210\u529F"})}else{const{data:l}=await c.patch("/products/"+e._id,a);i[e.idx]=l.result,m.fire({icon:"success",title:"\u6210\u529F",text:"\u7DE8\u8F2F\u6210\u529F"})}e.dialog=!1}catch(l){m.fire({icon:"error",title:"\u5931\u6557",text:((n=(t=l==null?void 0:l.response)==null?void 0:t.data)==null?void 0:n.message)||"\u767C\u751F\u932F\u8AA4"})}};return(async()=>{var a,t;try{const{data:n}=await c.get("/products/all");i.push(...n.result)}catch(n){m.fire({icon:"error",title:"\u5931\u6557",text:((t=(a=n==null?void 0:n.response)==null?void 0:a.data)==null?void 0:t.message)||"\u767C\u751F\u932F\u8AA4"})}})(),(a,t)=>{const n=C("v-image-input");return f(),h(N,{id:"admin-products-view"},{default:r(()=>[o("section",P,[o("div",J,[o("div",L,[M,o("div",j,[s(u,{color:"warning",label:"\u65B0\u589E\u9910\u9EDE",onClick:t[0]||(t[0]=l=>V(-1)),class:"q-mb-md"}),s(z,{modelValue:e.dialog,"onUpdate:modelValue":t[9]||(t[9]=l=>e.dialog=l),persistent:""},{default:r(()=>[s(y,{style:{width:"700px","max-width":"80vw"}},{default:r(()=>[s(q,{class:"bg-warning text-white"},{default:r(()=>[s(B,null,{default:r(()=>[o("div",G,p(e._id.length>0?"\u7DE8\u8F2F\u9910\u9EDE":"\u65B0\u589E\u9910\u9EDE"),1)]),_:1})]),_:1}),s(D,{modelValue:e.valid,"onUpdate:modelValue":t[8]||(t[8]=l=>e.valid=l),onSubmit:w},{default:r(()=>[s(y,{class:"q-pa-md"},{default:r(()=>[s(A,{class:"q-pt-none"},{default:r(()=>[s(g,{filled:"",modelValue:e.name,"onUpdate:modelValue":t[1]||(t[1]=l=>e.name=l),autofocus:"",label:"\u540D\u7A31",rules:[d.required]},null,8,["modelValue","rules"]),s(g,{filled:"",modelValue:e.price,"onUpdate:modelValue":t[2]||(t[2]=l=>e.price=l),autofocus:"",label:"\u50F9\u683C",rules:[d.required,d.price]},null,8,["modelValue","rules"]),s(S,{style:{"margin-bottom":"1.2rem"},filled:"",modelValue:e.category,"onUpdate:modelValue":t[3]||(t[3]=l=>e.category=l),options:b,label:"\u5206\u985E"},null,8,["modelValue"]),s(g,{filled:"",modelValue:e.description,"onUpdate:modelValue":t[4]||(t[4]=l=>e.description=l),autofocus:"",type:"textarea",rows:"3",label:"\u8AAA\u660E",rules:[d.required]},null,8,["modelValue","rules"]),s(T,{style:{"margin-bottom":"1.2rem"},modelValue:e.sell,"onUpdate:modelValue":t[5]||(t[5]=l=>e.sell=l),label:"\u4E0A\u67B6"},null,8,["modelValue"]),s(n,{style:{width:"200px"},modelValue:e.image,"onUpdate:modelValue":t[6]||(t[6]=l=>e.image=l),removable:"","max-file-size":1},null,8,["modelValue"])]),_:1}),s($,{align:"center"},{default:r(()=>[s(u,{type:"submit",label:"\u78BA\u5B9A",color:"positive"}),s(u,{onClick:t[7]||(t[7]=l=>e.dialog=!1),label:"\u53D6\u6D88",color:"negative"})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["modelValue"])]),o("div",H,[s(I,null,{default:r(()=>[K,o("tbody",O,[(f(!0),v(U,null,k(i,(l,x)=>(f(),v("tr",{key:l._id},[o("td",null,[s(E,{src:l.image,ratio:1,width:"150px"},null,8,["src"])]),o("td",null,p(l.name),1),o("td",null,p(l.price),1),o("td",null,p(l.category),1),o("td",null,[s(F,{modelValue:l.sell,"onUpdate:modelValue":_=>l.sell=_,color:"green"},null,8,["modelValue","onUpdate:modelValue"])]),o("td",null,[s(u,{color:"warning",icon:"edit",onClick:_=>V(x)},null,8,["onClick"])])]))),128))])]),_:1})])])])])]),_:1})}}};export{ve as default};

import{a0 as y,aJ as f,ar as m,o as u,C as w,D as r,E as C,a as o,F as s,Q as p,az as c,c as g,aA as k,aB as U,b as q}from"./index.d08e27b9.js";import{Q as B,a as D}from"./QToolbar.7c76fa42.js";import{Q as S,a as _}from"./QForm.1683f2c1.js";import{Q as T,a as F,b as A}from"./QToggle.b5111174.js";import{Q as N}from"./QCardSection.030f5809.js";import{Q as $}from"./QCardActions.16af8580.js";import{Q as b}from"./QCard.fea2560a.js";import{Q as z}from"./QDialog.55221b7c.js";import{Q as E}from"./QImg.aa03aff4.js";import{Q as I}from"./QMarkupTable.eb878910.js";import{Q as P}from"./QPage.06412def.js";import"./use-dark.8a6f7d0a.js";import"./uid.42677368.js";import"./focus-manager.d6507951.js";import"./QItemLabel.a6a03fad.js";import"./QMenu.16a5328b.js";import"./selection.64e96778.js";import"./use-prevent-scroll.f4b8d4e1.js";import"./focusout.b12d83d8.js";import"./use-tick.e1b8a0f0.js";import"./use-timeout.a018c730.js";import"./rtl.b51694b1.js";import"./format.865294d5.js";const J={id:"section01"},L={class:"container"},M={class:"row"},j=o("div",{class:"col-12 text-center text-white text-h3 text"},"\u9910\u9EDE\u7BA1\u7406",-1),G={class:"col-12 text-right"},H={class:"text-center"},K={class:"col-12"},O=o("thead",{class:"text-center"},[o("tr",null,[o("th",null,"\u7167\u7247"),o("th",null,"\u540D\u7A31"),o("th",null,"\u50F9\u683C"),o("th",null,"\u5206\u985E"),o("th",null,"\u4E0A\u67B6"),o("th",null,"\u7DE8\u8F2F")])],-1),R={class:"text-center"},W={key:0},X=o("td",{class:"text-center text-h6",colspan:"6"},"\u6C92\u6709\u9910\u9EDE",-1),Y=[X],he={__name:"ProductsView",setup(Z){const v=["shot","\u8336\u9152","\u7279\u8ABF","\u5976\u9152","\u5564\u9152","\u7121\u9152\u7CBE","\u62FC\u76E4","\u55AE\u9EDE"],d={required(a){return!!a||"\u6B04\u4F4D\u5FC5\u586B"},price(a){return a>=0||"\u50F9\u683C\u932F\u8AA4"}},i=y([]),e=y({_id:"",name:"",price:0,description:"",image:void 0,sell:!1,category:"",valid:!1,dialog:!1,idx:-1}),V=a=>{a===-1?(e._id="",e.name="",e.price=0,e.description="",e.image=void 0,e.sell=!1,e.category="",e.valid=!1,e.idx=-1):(e._id=i[a]._id,e.name=i[a].name,e.price=i[a].price,e.description=i[a].description,e.image=void 0,e.sell=i[a].sell,e.category=i[a].category,e.valid=!1,e.idx=a),e.dialog=!0},x=async()=>{var l,n;const a=new FormData;a.append("name",e.name),a.append("price",e.price),a.append("description",e.description),a.append("image",e.image),a.append("sell",e.sell),a.append("category",e.category);try{if(e._id.length===0){const{data:t}=await f.post("/products",a);i.push(t.result),m.fire({icon:"success",title:"\u6210\u529F",text:"\u65B0\u589E\u6210\u529F"})}else{const{data:t}=await f.patch("/products/"+e._id,a);i[e.idx]=t.result,m.fire({icon:"success",title:"\u6210\u529F",text:"\u7DE8\u8F2F\u6210\u529F"})}e.dialog=!1}catch(t){m.fire({icon:"error",title:"\u5931\u6557",text:((n=(l=t==null?void 0:t.response)==null?void 0:l.data)==null?void 0:n.message)||"\u767C\u751F\u932F\u8AA4"})}};return(async()=>{var a,l;try{const{data:n}=await f.get("/products/all");i.push(...n.result)}catch(n){m.fire({icon:"error",title:"\u5931\u6557",text:((l=(a=n==null?void 0:n.response)==null?void 0:a.data)==null?void 0:l.message)||"\u767C\u751F\u932F\u8AA4"})}})(),(a,l)=>{const n=C("v-image-input");return u(),w(P,{id:"admin-products-view"},{default:r(()=>[o("section",J,[o("div",L,[o("div",M,[j,o("div",G,[s(p,{color:"warning",label:"\u65B0\u589E\u9910\u9EDE",onClick:l[0]||(l[0]=t=>V(-1)),class:"q-mb-md"}),s(z,{modelValue:e.dialog,"onUpdate:modelValue":l[9]||(l[9]=t=>e.dialog=t),persistent:""},{default:r(()=>[s(b,{style:{width:"700px","max-width":"80vw"}},{default:r(()=>[s(B,{class:"bg-warning text-white"},{default:r(()=>[s(D,null,{default:r(()=>[o("div",H,c(e._id.length>0?"\u7DE8\u8F2F\u9910\u9EDE":"\u65B0\u589E\u9910\u9EDE"),1)]),_:1})]),_:1}),s(S,{modelValue:e.valid,"onUpdate:modelValue":l[8]||(l[8]=t=>e.valid=t),onSubmit:x},{default:r(()=>[s(b,{class:"q-pa-md"},{default:r(()=>[s(N,{class:"q-pt-none"},{default:r(()=>[s(_,{filled:"",modelValue:e.name,"onUpdate:modelValue":l[1]||(l[1]=t=>e.name=t),autofocus:"",label:"\u540D\u7A31",rules:[d.required]},null,8,["modelValue","rules"]),s(_,{filled:"",modelValue:e.price,"onUpdate:modelValue":l[2]||(l[2]=t=>e.price=t),autofocus:"",label:"\u50F9\u683C",rules:[d.required,d.price]},null,8,["modelValue","rules"]),s(T,{style:{"margin-bottom":"1.2rem"},filled:"",modelValue:e.category,"onUpdate:modelValue":l[3]||(l[3]=t=>e.category=t),options:v,label:"\u5206\u985E"},null,8,["modelValue"]),s(_,{filled:"",modelValue:e.description,"onUpdate:modelValue":l[4]||(l[4]=t=>e.description=t),autofocus:"",type:"textarea",rows:"3",label:"\u8AAA\u660E",rules:[d.required]},null,8,["modelValue","rules"]),s(F,{style:{"margin-bottom":"1.2rem"},modelValue:e.sell,"onUpdate:modelValue":l[5]||(l[5]=t=>e.sell=t),label:"\u4E0A\u67B6"},null,8,["modelValue"]),s(n,{style:{width:"200px"},modelValue:e.image,"onUpdate:modelValue":l[6]||(l[6]=t=>e.image=t),removable:"","max-file-size":1},null,8,["modelValue"])]),_:1}),s($,{align:"center"},{default:r(()=>[s(p,{type:"submit",label:"\u78BA\u5B9A",color:"positive"}),s(p,{onClick:l[7]||(l[7]=t=>e.dialog=!1),label:"\u53D6\u6D88",color:"negative"})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["modelValue"])]),o("div",K,[s(I,null,{default:r(()=>[O,o("tbody",R,[(u(!0),g(U,null,k(i,(t,h)=>(u(),g("tr",{key:t._id},[o("td",null,[s(E,{src:t.image,ratio:1,width:"150px"},null,8,["src"])]),o("td",null,c(t.name),1),o("td",null,c(t.price),1),o("td",null,c(t.category),1),o("td",null,[s(A,{modelValue:t.sell,"onUpdate:modelValue":Q=>t.sell=Q,color:"green"},null,8,["modelValue","onUpdate:modelValue"])]),o("td",null,[s(p,{color:"warning",icon:"edit",onClick:Q=>V(h)},null,8,["onClick"])])]))),128)),i.length===0?(u(),g("tr",W,Y)):q("",!0)])]),_:1})])])])])]),_:1})}}};export{he as default};

import{a0 as Q,aJ as f,ar as m,o as g,C as h,D as n,a,F as s,Q as p,az as d,c as _,aA as U,aB as N}from"./index.b6c41a35.js";import{Q as C,a as q}from"./QToolbar.bb198865.js";import{Q as B,a as b}from"./QForm.fbfdc224.js";import{Q as S,a as y,b as k}from"./QToggle.897105ac.js";import{Q as D}from"./QCardSection.48c9c9c2.js";import{Q as T}from"./QCardActions.91b00c83.js";import{Q as v}from"./QCard.1c3d8f0e.js";import{Q as F}from"./QDialog.af11d8cb.js";import{Q as A}from"./QMarkupTable.4e546f52.js";import{Q as $}from"./QPage.f7afd3d8.js";import"./use-dark.11607062.js";import"./uid.42677368.js";import"./focus-manager.d6507951.js";import"./QItemLabel.e45e2863.js";import"./QMenu.01b20ee1.js";import"./selection.8b508325.js";import"./use-prevent-scroll.0107a6b2.js";import"./focusout.e8870aba.js";import"./use-tick.a5ce9da0.js";import"./use-timeout.3930d7da.js";import"./rtl.b51694b1.js";import"./format.865294d5.js";const z={id:"section01"},E={class:"container"},I={class:"row"},J=a("div",{class:"col-12 text-center text-white text-h3 text"},"\u5EA7\u4F4D\u7BA1\u7406",-1),L={class:"col-12 text-right"},M={class:"text-center"},P={class:"col-12"},j=a("thead",{class:"text-center"},[a("tr",null,[a("th",null,"\u7DE8\u865F"),a("th",null,"\u6A13\u5C64"),a("th",null,"\u4F4D\u6578"),a("th",null,"\u5206\u985E"),a("th",null,"\u662F\u5426\u958B\u653E"),a("th",null,"\u662F\u5426\u4F7F\u7528\u4E2D"),a("th",null,"\u7DE8\u8F2F")])],-1),G={class:"text-center"},ge={__name:"SeatsView",setup(H){const w=["\u5427\u6AAF","\u5C0F\u684C","\u4E2D\u684C","\u5927\u684C"],c={required(t){return!!t||"\u6B04\u4F4D\u5FC5\u586B"}},r=Q([]),e=Q({_id:"",name:"",floor:"",seatNumber:0,book:!1,using:!1,category:"",valid:!1,dialog:!1,idx:-1}),V=t=>{t===-1?(e._id="",e.name="",e.floor="",e.seatNumber=0,e.book=!1,e.using=!1,e.category="",e.valid=!1,e.idx=-1):(e._id=r[t]._id,e.name=r[t].name,e.floor=r[t].floor,e.seatNumber=r[t].seatNumber,e.book=r[t].book,e.using=r[t].using,e.category=r[t].category,e.valid=!1,e.idx=t),e.dialog=!0},x=async()=>{var o,l;const t=new FormData;t.append("name",e.name),t.append("floor",e.floor),t.append("seatNumber",e.seatNumber),t.append("book",e.book),t.append("using",e.using),t.append("category",e.category);try{if(e._id.length===0){const{data:i}=await f.post("/seats",t);r.push(i.result),m.fire({icon:"success",title:"\u6210\u529F",text:"\u65B0\u589E\u6210\u529F"})}else{const{data:i}=await f.patch("/seats/"+e._id,t);r[e.idx]=i.result,m.fire({icon:"success",title:"\u6210\u529F",text:"\u7DE8\u8F2F\u6210\u529F"})}e.dialog=!1}catch(i){m.fire({icon:"error",title:"\u5931\u6557",text:((l=(o=i==null?void 0:i.response)==null?void 0:o.data)==null?void 0:l.message)||"\u767C\u751F\u932F\u8AA4"})}};return(async()=>{var t,o;try{const{data:l}=await f.get("/seats/all");r.push(...l.result)}catch(l){m.fire({icon:"error",title:"\u5931\u6557",text:((o=(t=l==null?void 0:l.response)==null?void 0:t.data)==null?void 0:o.message)||"\u767C\u751F\u932F\u8AA4"})}})(),(t,o)=>(g(),h($,{id:"admin-seats-view"},{default:n(()=>[a("section",z,[a("div",E,[a("div",I,[J,a("div",L,[s(p,{color:"warning",label:"\u65B0\u589E\u5EA7\u4F4D",onClick:o[0]||(o[0]=l=>V(-1)),class:"q-mb-md"}),s(F,{modelValue:e.dialog,"onUpdate:modelValue":o[9]||(o[9]=l=>e.dialog=l),persistent:""},{default:n(()=>[s(v,{style:{width:"700px","max-width":"80vw"}},{default:n(()=>[s(C,{class:"bg-primary text-white"},{default:n(()=>[s(q,null,{default:n(()=>[a("div",M,d(e._id.length>0?"\u7DE8\u8F2F\u5EA7\u4F4D":"\u65B0\u589E\u5EA7\u4F4D"),1)]),_:1})]),_:1}),s(B,{modelValue:e.valid,"onUpdate:modelValue":o[8]||(o[8]=l=>e.valid=l),onSubmit:x},{default:n(()=>[s(v,{class:"q-pa-md"},{default:n(()=>[s(D,{class:"q-pt-none"},{default:n(()=>[s(b,{filled:"",modelValue:e.name,"onUpdate:modelValue":o[1]||(o[1]=l=>e.name=l),autofocus:"",label:"\u7DE8\u865F",rules:[c.required]},null,8,["modelValue","rules"]),s(b,{filled:"",modelValue:e.floor,"onUpdate:modelValue":o[2]||(o[2]=l=>e.floor=l),autofocus:"",label:"\u6A13\u5C64",rules:[c.required]},null,8,["modelValue","rules"]),s(S,{style:{"margin-bottom":"1.2rem"},filled:"",modelValue:e.category,"onUpdate:modelValue":o[3]||(o[3]=l=>e.category=l),options:w,label:"\u5206\u985E"},null,8,["modelValue"]),s(b,{filled:"",modelValue:e.seatNumber,"onUpdate:modelValue":o[4]||(o[4]=l=>e.seatNumber=l),autofocus:"",label:"\u4F4D\u6578",rules:[c.required]},null,8,["modelValue","rules"]),s(y,{style:{"margin-bottom":"1.2rem"},modelValue:e.book,"onUpdate:modelValue":o[5]||(o[5]=l=>e.book=l),label:"\u662F\u5426\u958B\u653E"},null,8,["modelValue"]),s(y,{style:{"margin-bottom":"1.2rem"},modelValue:e.using,"onUpdate:modelValue":o[6]||(o[6]=l=>e.using=l),label:"\u662F\u5426\u4F7F\u7528\u4E2D"},null,8,["modelValue"])]),_:1}),s(T,{align:"center"},{default:n(()=>[s(p,{type:"submit",label:"\u78BA\u5B9A",color:"positive"}),s(p,{onClick:o[7]||(o[7]=l=>e.dialog=!1),label:"\u53D6\u6D88",color:"negative"})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["modelValue"])]),a("div",P,[s(A,null,{default:n(()=>[j,a("tbody",G,[(g(!0),_(N,null,U(r,(l,i)=>(g(),_("tr",{key:l._id},[a("td",null,d(l.name),1),a("td",null,d(l.floor),1),a("td",null,d(l.seatNumber),1),a("td",null,d(l.category),1),a("td",null,[s(k,{modelValue:l.book,"onUpdate:modelValue":u=>l.book=u,color:"green"},null,8,["modelValue","onUpdate:modelValue"])]),a("td",null,[s(k,{modelValue:l.using,"onUpdate:modelValue":u=>l.using=u,color:"green"},null,8,["modelValue","onUpdate:modelValue"])]),a("td",null,[s(p,{color:"warning",icon:"edit",onClick:u=>V(i)},null,8,["onClick"])])]))),128))])]),_:1})])])])])]),_:1}))}};export{ge as default};
